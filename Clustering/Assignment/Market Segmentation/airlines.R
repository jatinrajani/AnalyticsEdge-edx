
load("~/Mitedx/LinearRegression/ClimateChange/.RData")
setwd("~/AnalyticsEdge-edx/Clustering/Assignment/Market Segmentation")
airlines=read.csv("AirlinesCluster.csv")
summary(airlines)
library("caret")
prepoc=preProcess(airlines)
airlinesNorm=predict(prepoc,airlines)
summary(airlinesNorm)
distances=dist(airlinesNorm,method="euclidean")
clustering=hclust(distances,method="ward.D")
k=5
clustergroups=cutree(clustering,k)
cluster1=subset(airlinesNorm,clustergroups==1)
cluster2=subset(airlinesNorm,clustergroups==2)
cluster3=subset(airlinesNorm,clustergroups==3)
cluster4=subset(airlinesNorm,clustergroups==4)
cluster5=subset(airlinesNorm,clustergroups==5)
plot(clustering)
str(cluster1)
colMeans(cluster1)
tapply(airlines$Balance,clustergroups,mean)
tapply(airlines$QualMiles,clustergroups,mean)
tapply(airlines$BonusMiles,clustergroups,mean)
tapply(airlines$FlightMiles,clustergroups,mean)
tapply(airlines$FlightTrans,clustergroups,mean)
tapply(airlines$BonusTrans,clustergroups,mean)
tapply(airlines$DaysSinceEnroll,clustergroups,mean)
set.seed(88)
k=5
KMC=kmeans(airlinesNorm,k,iter.max = 1000)
kmcluster=KMC$cluster
str(kmcluster)
KMCcluster1=subset(airlinesNorm,kmcluster==1)
KMCcluster2=subset(airlinesNorm,kmcluster==2)
KMCcluster3=subset(airlinesNorm,kmcluster==3)
KMCcluster3=subset(airlinesNorm,kmcluster==4)
KMCcluster3=subset(airlinesNorm,kmcluster==3)
KMCcluster4=subset(airlinesNorm,kmcluster==4)
KMCcluster5=subset(airlinesNorm,kmcluster==5)
str(KMCcluster1)
str(KMCcluster2)
str(KMCcluster3)
str(KMCcluster4)
str(KMCcluster5)
KMC$centers
tapply
tapply(airlines$Balance,KMC$cluster,mean)
table(clustergroups,KMC$cluster)
